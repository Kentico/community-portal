/* 
 * âœ… PHASE 3.3: Form components modernized with CSS API
 * 
 * PHILOSOPHY: Consolidated form patterns with design tokens
 * 
 * Benefits:
 * - Unified form styling approach via custom properties
 * - Semantic variant attributes for different input types
 * - Centralized validation and tooltip theming
 * - Reduced class proliferation
 * 
 * Usage:
 * <input class="form-control" variant="search" />
 * <select class="form-select" variant="subheading" />
 * <div class="form-validation" role="alert">Error message</div>
 */

/* Modern CSS API-based form inputs */
:where(.form-control, .form-select) {
  --input-bg: var(--bs-body-bg);
  --input-border-color: var(--bs-border-color);
  --input-focus-border-color: var(--bs-primary);
  --input-icon-size: 1rem;
  --input-icon-spacing: 2.75rem;
}

/* Search input variant */
.form-control[variant="search"] {
  background-image: url("#{$img-path}/icons/search.svg");
  background-repeat: no-repeat;
  background-position: left 1.125rem center;
  background-size: var(--input-icon-size);
  padding-left: var(--input-icon-spacing);
}

/* Textarea styling */
textarea.form-control {
  height: 6.25rem;
  resize: none;
}

/* File input styling */
.form-control[type="file"] {
  color: inherit;
  background: transparent;
}

/* Field sizing utility */
.form-control[sizing="content"] {
  field-sizing: content;
}

/* Modern CSS API-based validation */
:where(.form-validation) {
  --validation-color: var(--bs-danger);
  --validation-font-size: 0.75rem;

  color: rgb(var(--bs-danger-rgb));
  font-size: var(--validation-font-size);

  ul {
    margin-top: 1rem;
    padding-left: 1rem;
  }
}

/* Validation summary component */
:where(.validation-summary) {
  --validation-color: var(--bs-danger);
  --validation-font-size: var(--font-size-5);

  color: rgb(var(--bs-danger-rgb));
  font-size: var(--validation-font-size);

  ul {
    margin: 0;
  }

  &.is-valid {
    display: none;
  }
}

/* Legacy validation class support */
.field-validation-error {
  @extend .form-validation;
}

/* Form tooltip component */
:where(.form-tooltip) {
  --tooltip-size: 1.5rem;
  --tooltip-icon-size: 1rem;

  display: inline-flex;
  width: var(--tooltip-size);
  height: var(--tooltip-icon-size);
  align-items: center;
  cursor: pointer;
  padding: 0 0.25rem;
  vertical-align: text-bottom;

  svg,
  img {
    width: var(--tooltip-icon-size);
    height: var(--tooltip-icon-size);
  }
}

/* Required field indicator */
label:has(
    + input[data-val-required],
    + textarea[data-val-required],
    + .form-tooltip + input[data-val-required],
    + select[data-val-required]
  ):after {
  content: "*";
  margin-inline-start: 0.2rem;
}

.field-sizing-content {
  field-sizing: content;
}

/* HTMX loading states */
[loading-content] {
  display: none;
}

.htmx-request {
  [loading-content] {
    display: initial;
  }
  [default-content] {
    display: none;
  }
}
